{% extends 'base.html'%}
{% load static %}

{% block page-css %}
    <link href="{% static 'OsasSystem/assets/plugins/DataTables/media/css/dataTables.bootstrap.min.css' %}" rel="stylesheet" />
    <link href="{% static 'OsasSystem/assets/plugins/bootstrap-eonasdan-datetimepicker/build/css/bootstrap-datetimepicker.min.css' %}" rel="stylesheet" />
    <link href="{% static 'OsasSystem/assets/plugins/DataTables/extensions/Responsive/css/responsive.bootstrap.min.css' %}" rel="stylesheet" />

    <link href="{% static 'OsasSystem/assets/plugins/isotope/isotope.css' %}" rel="stylesheet" />
    <link href="{% static 'OsasSystem/assets/plugins/lightbox/css/lightbox.css' %}" rel="stylesheet" />

    <link href="{%static 'OsasSystem/assets/plugins/dropzone/min/dropzone.min.css' %}" rel="stylesheet" />
{% endblock%}

{% block title %}
    Year and Section
{% endblock %}


{% block content%}
<div id="content" class="content">
    <ol class="breadcrumb pull-right">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Dashboard</a></li>
        <li class="breadcrumb-item">Facilitation Student Activites</li>
        <li class="breadcrumb-item">Accreditation</li>
    </ol>
    <h1 class="page-header mb-1"><i class="fas fa-upload mr-2" ></i> Accreditaion</h1>
    <p class="mb-5">Page Description</p>
    <img hidden id="myImg" style="width: auto; height: auto;"/>
    <img hidden id="myImg2" style="width: auto; height: auto;"/>
    <img hidden id="myImg3" style="width: auto; height: auto;"/>
    <img hidden id="myImg4" style="width: auto; height: auto;"/>
    <div class="row">
        <div class="col-lg-2">
            <div class="panel" data-sortable-id="index-1">
                <div class="panel-heading p-25">
                    <h2 class="panel-title" style="font-size:16px;">Filter <i class="fas fa-filter mr-2" ></i></h2>
                </div>
                <div class="panel-body" style="padding: 0%; height: 200px;">
                    <form id="validate_form" method="POST" action="{% url 'organization_accreditation' %}" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-group" >
                            <label style="text-align: left; margin-bottom: 7px; margin-top: 4px;" class="col-sm-12">Academic Year:</label> 
                            <div class="col-sm-12">
                                <select id="acad_year" name="acad_year" class="form-control">
                                    <option selected disabled="true">--Select--</option>
                                    <option  value="2016">2016 - 2017</option>
                                    <option  value="2017">2017 - 2018</option>
                                    <option  value="2018">2018 - 2019</option>
                                    <option  value="2019">2019 - 2020</option>
                                    <option  value="2020">2020 - 2021</option>
                                    <option  value="2021">2021 - 2022</option>
                                </select>
                            </div>
                            <label style="text-align: left; margin-bottom: 7px; margin-top: 4px;" class="col-sm-12">Status:</label> 
                            <div class="col-sm-12">
                                <select id="filter_status" name="filter_status" class="form-control">
                                    <option selected disabled="true">--Select--</option>
                                    <option  value="ACCREDITED">Accredited</option>
                                    <option  value="EXPIRED">Expired</option>
                                    <option  value="DISMISSED">Dismissed</option>
                                    <option  value="INACTIVE">Inactive</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <button type="submit" class="btn btn-success col-sm-12">Filter <i class="fas fa-filter mr-2" ></i></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-lg-10">
            <div class="panel">
                <div class="panel-heading p-25">
                    <div class="btn-group btn-group-toggle pull-right" data-toggle="buttons" style="margin-right: -10px; margin-bottom: -10px;">
                        <button class="btn btn-white"  id="donwload" ><i class="far fa-file-pdf mr-2"></i>Report</button>
                    </div>
                    <h2 class="panel-title" style="font-size:16px;"><i class="fas fa-calendar-alt mr-2" ></i>Accreditation Documents List</h2>  
                </div>
                <div class="panel-body">
                    {% if acc_list %}
                    <table id="data-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th width="1%"></th>
                                <th data-orderable="false">Organization Info</th>
                                <th data-orderable="false">Accreditaion Documents</th>
                                <th data-orderable="false">Notes</th>
                                <th data-orderable="false">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for organization in acc_list %}
                            <tr class="odd gradeA tr_  align-middle" id="{{ organization.org_id }}">
                                <td width="1%" class="f-s-600 text-inverse">{{ forloop.counter }}</td>
                                <td width="30%" ><dl class="row mb-0 p-2" style="line-height: .6rem;">
                                    <dd class="col-sm-8 gritter-  ysd{{ organization.org_id  }}" style=" font-size: 11px; "><strong>{{ organization.org_name }}</strong></dd>
                                    <dd class="col-sm-8 gritter-  ysd{{ organization.org_id  }} " style=" font-size: 11px; ">{{ organization.org_stud_id.stud_lname }}, {{ organization.org_stud_id.stud_fname }} {{ organization.org_stud_id.stud_mname }}</dd>
                                    <dd class="col-sm-8 gritter-  ysd{{ organization.org_id  }}" >{{ organization.org_date_accredited|date:"Y-m-d" }}</dd>
                                    {% if organization.org_status == "ACCREDITED" %}
                                    <dd class="col-sm-8 gritter- "><strong><span class="badge badge-success  yss{{ organization.org_id }}">{{ organization.org_status }}</span></strong></dd>
                                    {% elif organization.org_status == "DISMISSED" %}
                                    <dd class="col-sm-8 gritter- "><strong><span class="badge badge-danger  yss{{ organization.org_id }}">{{ organization.org_status }}</span></strong></dd>
                                    {% elif organization.org_status == "EXPIRED" %}
                                    <dd class="col-sm-8 gritter- "><strong><span class="badge badge-danger  yss{{ organization.org_id }}">{{ organization.org_status }}</span></strong></dd>
                                    {% else %}
                                    <dd class="col-sm-8 gritter- "><strong><span class="badge badge-warning  yss{{ organization.org_id }}">{{ organization.org_status }}</span></strong></dd>
                                    {% endif %}
                                </dl>
                                </td>
                                <td width="45%">
                                    {% if acc_docu %}
                                    {% for org_accreditation in acc_docu%}
                                    {% if org_accreditation.acc_doc_type == '.docx' and org_accreditation.acc_org_id.org_id == organization.org_id%}
                                    <div style=" display: inline-block; padding: 2px;">
                                        <a id="{{ organization.org_id  }}" href="/media/{{ org_accreditation.acc_file }}" target="blank"><i class="far fa-file-word fa-2x" > </i></a>
                                    </div>
                                    <div style="display: inline-block;">
                                        <a id="{{ organization.org_id  }}" href="/media/{{ org_accreditation.acc_file }}" target="blank" style="color: rgb(95, 94, 94);">{{ org_accreditation.acc_file }}</a>
                                    </div></br>
                                    {% elif org_accreditation.acc_org_id.org_id == organization.org_id %}
                                    <div style="display: inline-block; padding: 2px;">
                                        <a id="{{ organization.org_id  }}" href="/media/{{ org_accreditation.acc_file }}" target="blank" style="color: red;"><i class="far fa-file-pdf fa-2x" > </i></a>
                                    </div>
                                    <div style="display: inline;">
                                        <a id="{{ organization.org_id  }}" href="/media/{{ org_accreditation.acc_file }}" target="blank" style="color: rgb(95, 94, 94);">{{ org_accreditation.acc_file }}</a>
                                    </div><br>
                                    {% endif %}
                                    {% endfor %}
                                    {% endif %}
                                </td>
                                <td width="11%">
                                    <dl class="row mb-0 p-2" style="line-height: .6rem;">
                                        {% if organization.org_notes == None%}
                                       
                                        {% else %}
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="add_note" class="btn btn-info" data-toggle="modal" href="#modal_view" onClick="viewNote('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-eye mr-2"></i>View Note</button>
                                        </div>
                                        {% endif %}
                                    </dl>
                                </td>
                                <td width="8%" class="text-nowrap  m-l-5">
                                        {% if organization.org_notes == None%}
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="add_note" class="btn btn-white" data-toggle="modal" href="#modal_addnote" onClick="addNote('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-plus mr-2"></i>Add Note</button>
                                        </div>
                                        {% else %}
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="add_note" class="btn btn-white" data-toggle="modal" href="#modal_addnote" onClick="addNote('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-edit mr-2"></i>Edit Note</button>
                                        </div>
                                        {% endif %}
                                        <!-- <div class="btn-group p-2" style=" float: left;">
                                            <button id="edit-btn" class="btn btn-success" data-toggle="modal" href="#modal_upload" onClick="uploadDocu('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-upload mr-2"></i>Upload</button>
                                        </div> -->
                                        {% if organization.org_status == 'ACCREDITED' %}
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="edit-btn" class="btn btn-danger" onClick="dismissOrg('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-trash mr-2"></i>Dismiss</button>
                                        </div>
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="e_cert" class="btn btn-warning" onClick="viewCert('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-file mr-2"></i>Certificate</button>
                                        </div>
                                        {% else %}
                                        <div class="btn-group p-2" style=" float: left;">
                                            <button id="edit-btn" class="btn btn-success" onClick="approveDocu('{{organization.org_id}}')" style="width: 104.72px;"><i class="fas fa-check mr-2"></i>Renew</button>
                                        </div>
                                        {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <table id="data-table" class="table table-striped table-bordered tabless">
                        <thead>
                            <tr>
                                <th width="1%"></th>
                                <th data-orderable="false">Organization Info</th>
                                <th data-orderable="false">Accreditaion Documents</th>
                                <th data-orderable="false">Notes</th>
                                <th data-orderable="false">Action</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table> 
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_view_academic" role="dialog" data-backdrop="static" >
    <div class="modal-dialog modal-md" >
        <div class="modal-content " style="background-color:whitesmoke;" >
            <div class="panel panel-inverse" style="border-radius: 15px;">
                <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" style="color: gray; margin: 6px;">×</button>
                <div class="panel-body"  style="background-color:whitesmoke;" id="notes_body">
                    <h1 class="page-header mb-1"><i class="fas fa-calendar-alt mr-2" ></i> Academic School Year</h1>
                    <p class="mb-5">Academic School Year</p>
                    <select id="acad_year" name="acad_year" class="form-control">
                        <option selected disabled="true">--Select--</option>
                        <option  value="2016">2016 - 2017</option>
                        <option  value="2017">2017 - 2018</option>
                        <option  value="2018">2019 - 2020</option>
                        <option  value="2019">2020 - 2021</option>
                    </select>

                </div>
                          
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_view_docu" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-lg" >
        <div class="modal-content " style="background-color:whitesmoke;" >
            <div class="panel panel-inverse" style="border-radius: 15px; background-color:whitesmoke;">
                <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" style="color: gray; margin: 6px;">×</button>
                <div class="panel-body"  style="background-color:whitesmoke;" id="notes_body">
                    <div class="col">
                        <h1 class="page-header mb-1">Upload Certificate</h1>
                        <p class="mb-5">Page Description</p>
                    <table id="data-table" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th width="1%"></th>
                                <th data-orderable="false">File Uploaded</th>
                                <th data-orderable="false">Action</th>
                            </tr>
                            <tbody>
                            
                            </tbody>
                        </thead>
                    </table>
                    </div>
                    <a id="note_btn" class="btn btn-white pull-right" style="margin-top: 20px;" data-dismiss="modal">Back <i class="fas fa-reply m-l-3 zoom"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="modal fade" id="modal_upload" role="dialog" data-backdrop="static">
        <div class="modal-dialog modal-md" >
            <div class="modal-content " style="background-color:whitesmoke;" >
                <div class="panel panel-inverse" style="border-radius: 15px; background-color:whitesmoke;">
                    <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" style="color: gray; margin: 6px;">×</button>
                    <div class="panel-body"  style="background-color:whitesmoke;" id="notes_body">
                        <div class="col">
                            <h1 class="page-header mb-1">Upload Certificate</h1>
                            <p class="mb-5">Page Description</p>
                            <input class="form-control" id="org_id2" type="hidden" name="org_id2"/>
                        <div id="dropzone">
                            <form action="{%url 'organization_upload_osas' %}" method="POST" class="dropzone needsclick" id="file-upload">
                                {% csrf_token %}
                                <div class="fallback">
                                    <input name="file" type="file" multiple id="document_file" />
                                </div>
                            </form>
                        </div>
                        <br>
                        <table id="data-table" class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th width="1%"></th>
                                    <th data-orderable="false">File Uploaded</th>
                                    <th data-orderable="false">Action</th>
                                </tr>
                                <tbody>
                                </tbody>
                            </thead>
                        </table>
                        </div>
                        
                        <a id="note_btn" class="btn btn-white pull-right" style="margin-top: 20px;" data-dismiss="modal">Back <i class="fas fa-reply m-l-3 zoom"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modal_view" role="dialog" data-backdrop="static" >
        <div class="modal-dialog modal-md" >
            <div class="modal-content " style="background-color:whitesmoke;" >
                <div class="panel panel-inverse" style="border-radius: 15px;">
                    <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" style="color: gray; margin: 6px;">×</button>
                    <div class="panel-body"  style="background-color:whitesmoke;" id="notes_body">
                        <input class="form-control" id="org_id1" type="hidden" name="org_id1"/>

                    </div>
                              
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modal_addnote" role="dialog"  data-backdrop="static">
        <div class="modal-dialog modal-md" role="document" id="myModal">
            <div class="modal-content">
                <input class="form-control" id="excuse_id" type="hidden" name="excuse_id"/>
                <div class="panel panel-inverse" >
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="color: gray; margin: 6px;">×</button>  
                    <div class="panel-body">
                        <div class="col">
                            <h1 class="page-header mb-1">Add new note</h1>
                            <p class="mb-5">Page Description</p>
                            <div class="col-lg-12" id="error">
                            </div>
                            <div class="col-lg-12 col-md-6">
                                <input class="form-control" id="org_id" type="hidden" name="sanction_id"/>
                                <textarea class="form-control essay_text" id="essay_text"  name="essay_text" placeholder="Write your reason here..."></textarea><br>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer">
                        <button class="btn btn_success col-md-3 pull-right m-l-10 " id="btn_submit" style="height: 33px; padding: 5px; background: linear-gradient(to right, #66ccff -1%, #3366ff 98%); border:none; color: white;" >Submit<i class="far fa-paper-plane m-l-3 zoom" ></i></button>
                        <a class="btn btn-white pull-right m-l-10" data-dismiss="modal">Back<i class="fas fa-reply m-l-3 zoom"></i></a>
                    </div>
                    <br>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block page-level %}
    <!-- <script src="{% static 'OsasSystem/assets/plugins/bootstrap-eonasdan-datetimepicker/build/js/bootstrap-datetimepicker.min.js' %}"></script> -->
	<script src="{%static 'OsasSystem/assets/plugins/bootstrap-sweetalert/sweetalert.min.js' %}"></script>
	<script src="{%static 'OsasSystem/assets/js/demo/ui-modal-notification.demo.min.js' %}"></script>
    <script src="{%static 'OsasSystem/assets/index.js' %}"></script>

    <script src="{%static 'OsasSystem/assets/plugins/isotope/jquery.isotope.min.js' %}"></script>
  	<script src="{%static 'OsasSystem/assets/plugins/lightbox/js/lightbox.min.js' %}"></script>
	<script src="{%static 'OsasSystem/assets/js/demo/gallery.demo.min.js' %}"></script>

    <script src="{%static 'OsasSystem/assets/plugins/dropzone/min/dropzone.min.js' %}"></script>
	<script src="{%static 'OsasSystem/assets/plugins/highlight/highlight.common.js' %}"></script>
	<script src="{%static 'OsasSystem/assets/js/demo/render.highlight.js' %}"></script>

    <script src="https://cdn.ckeditor.com/4.16.0/standard-all/ckeditor.js"></script>

    <script src="{%static 'OsasSystem/assets/js/demo/render.highlight.js' %}"></script>
    <script src="{%static 'OsasSystem/assets/plugins/highlight/highlight.common.js' %}"></script>
{% endblock %}
{% block page-js %}
<script>
    $(document).ready(function() {
        document.getElementById("myImg2").src = "/media/cert header.png";
        document.getElementById("myImg").src = "/media/cert footer.png";
        document.getElementById("myImg3").src = "/media/cert ssc.png";
        document.getElementById("myImg4").src = "/media/signature.jpg";
        $('#data-table').DataTable({
                    ordering: false,
        });
        orgData()
    });
</script>
<script>

function dismissOrg(org_id){
    if (org_id) {
        tr_id = org_id;
        console.log(org_id)
        swal({
            title: "Are you sure?",
            text: "You want to dismiss this organization?", 
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willDelete) => {
            if (willDelete) {
                $.ajax({
                    url: '{% url "organization_dismiss" %}',
                    type: "POST",
                    data: {
                        org_id: org_id,
                        csrfmiddlewaretoken: "{{ csrf_token }}",
                    },
                    dataType: 'json',
                    success: function (data) {
                        if (data.success) {
                            console.log(data.success)
                            window.location.reload()
                        // $("#data-table #" + auth_id).remove();
                        // const data_table = document.querySelector('#data-table tbody')
                        // if (data_table.rows.length == 0){
                        //     window.location.reload()
                        //     }
                        // swal("Success! User has been accredited.", {
                        //     icon: "success",
                        // });
                        }
                    }
                    
                });
            } 
        });
    }
} 

function orgData(){
    $.ajax({
        type:'GET',
        url : "{% url 'organization_accreditation_expired' %}",
        success: function(response){
            const orgData = response.data
            orgData.map(item=>{
                if (item.org_status == "ACCREDITED"){
                    console.log(item.org_expiration)
                    org_id = item.org_id
                    org_date = item.org_expiration
                    $.ajax({
                        url: '{% url "organization_expired" %}',
                        type: "POST",
                        data: {
                            org_id: org_id,
                            org_date: org_date,
                            csrfmiddlewaretoken: "{{ csrf_token }}",
                        },
                        dataType: 'json',
                        success: function (data) {
                            if (data.success) {
                                console.log(data.success)
                            $("#data-table #" + org_id).remove();

                            }
                        }
                    });
                }
             
               
            })
        },
        error: function(error){
            console.log(error)
        }
    })
}

function approveDocu(org_id){
    if (org_id) {
        tr_id = org_id;
        console.log(org_id)
        swal({
            title: "Are you sure?",
            text: "You want to aprrove the accreditation for", 
            text: "this organization?", 
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willDelete) => {
            if (willDelete) {
                $.ajax({
                    url: '{% url "organization_approve" %}',
                    type: "POST",
                    data: {
                        org_id: org_id,
                        csrfmiddlewaretoken: "{{ csrf_token }}",
                    },
                    dataType: 'json',
                    success: function (data) {
                        if (data.success) {
                            console.log(data.success)
                            window.location.reload()
                        // $("#data-table #" + auth_id).remove();
                        // const data_table = document.querySelector('#data-table tbody')
                        // if (data_table.rows.length == 0){
                        //     window.location.reload()
                        //     }
                        // swal("Success! User has been accredited.", {
                        //     icon: "success",
                        // });
                        }
                    }
                    
                });
            } 
        });
    }
} 

function viewCert(org_id){
    console.log(org_id)
    if (org_id) {

        tr_id = org_id;
        
        $.ajax({
            url: '{% url "organization_view_certificate" %}',
            type: "POST",
            data: {
                org_id: org_id,
                csrfmiddlewaretoken: "{{ csrf_token }}",
            },
            dataType: 'json',
            success: function(data){
                if (data.org_val) {
                    console.log(data.org_val.org_id)
                    var wme = window.open("","", "width = 816px, height = 1344px");
                    
                    wme.document.write(
                        '<div class="row" style="margin-top: -9px;"><img src="/media/cert header.png" style="width: auto; height: auto; margin-left: -7px"/></div>')

                    wme.document.write(
                    '<page size="Legal" style="word-wrap:break-word; margin: 0px;">')


                    const date_created = moment(data.org_val.org_date_accredited)
                    const new_date_created = date_created.format('LL')
                    console.log("Today's date is: " + date_created.format('LL'))  
                    
    
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; padding-top: 11.5px;"><label style="font-weight: bold; font-family: Times New Roman; font-size: 11.5px; ">'+new_date_created+'</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; padding-top: 46px;"><label style="font-weight: bold; font-family: Times New Roman; font-size: 11.5px; margin-top: 46px;">PROF. DEMELYN E. MONZON</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px;"><label style="font-style: italic; font-family: Times New Roman; font-size: 11.5px; margin-top: 46px;">Head, Office of the Student Affairs and Services</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px;"><label style="font-style: italic; font-family: Times New Roman; font-size: 11.5px; margin-top: 46px;">PUP Quezon City Branch</label></div>')

                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; line-height: 25px; text-indent: 50px;  font-family: Cambria; font-size: 12px; margin-top: 46.5px; text-align: justify;"><label style="">This is to certify that <b>'+data.org_val.org_name+'</b> or <b>'+data.org_val.org_abbr+'</b> is accredited under the supervision of PUPQC Office of the Student Affairs and Services and has already been cleared for financial liability in Supreme Student Council for the school year 2020 - 2021.</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; line-height: 25px; text-indent: 50px;  font-family: Cambria; font-size: 12px; margin-top: 10px; text-align: justify;"><label style="">This certification is issued upon the request of <b>'+data.org_val.org_name+'</b> for whatever purpose it may serve.</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; line-height: 25px;  font-family: Cambria; font-size: 12px; margin-top: 10px; text-align: justify;"><label style="">Thank you!</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px;  font-family: Times New Roman; font-size: 12px; margin-top: 12px; text-align: justify;"><label>Respectfully yours,</label></div>')

                    wme.document.write('<div style=" margin-left: 170px; margin-top: 10px;"><img src="/media/signature.jpg" style="width: 80; height: auto;"/></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; font-family: Times New Roman; font-size: 12px;  font-weight: bold;"><label >MS. SOPHIA VEINNE B. CERBO</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; font-family: Cambria; font-size: 12px; "><label >AUDIT DIVISION CHAIRPERSON, SSC</label></div>')
                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; font-family: Cambria; font-size: 12px; margin-top: 24px;"><label >Noted by:</label></div>')

                    wme.document.write('<div style=" margin-left: 170px;"><img src="/media/signature.jpg" style="width: 80; height: auto;"/></div>')

                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; font-family: Times New Roman; font-size: 12px; font-weight: bold;"><label >MR. DANILO ROBERTO MERCADO JR.</label></div>')

                    wme.document.write('<div style="padding-left: 96px; padding-right: 96px; font-family: Times New Roman; font-size: 10px;  font-style: italic;"><label >MR. DANILO ROBERTO MERCADO JR.</label></div>')
                    wme.document.write('<div class="row" style="padding-left: 96px; padding-right: 96px; padding-top: 40px;"><img src="/media/cert ssc.png" style="width: auto; height: auto;"/></div>')

                    wme.document.write('<div class="row" style="position: fixed; bottom: 0;"><img src="/media/cert footer.png" style="width: auto; height: auto; margin-left: -7.5px"/></div>')

                    wme.document.write('</page>')

                    
                    wme.document.close();
                    wme.focus()
                    wme.print();
                    wme.close();
                }
            },
            error: function(error){
                console.log(error)
            }
        })
    }
}

const progressBox = document.getElementById('progress-box')
const uploadForm = document.getElementById('upload-form')
const input = document.getElementById('document_file')

const csrf = document.getElementsByName('csrfmiddlewaretoken') 

function uploadDocu(org_id){
    if (org_id) {
        tr_id = org_id;
        $('#org_id2').val(org_id);
    }
} 


CKEDITOR.replace('essay_text',{
    height: 250,
    uiColor: '#9AB8F3',
});

function viewNote(org_id){
    if (org_id) {
        tr_id = org_id;
        $('#org_id1').val(org_id);
        console.log(org_id)
        if (document.getElementById("note")){
            var myobj = document.getElementById("note");
            myobj.remove();
        }
        if (document.getElementById("note_btn")){
            var myobj = document.getElementById("note_btn");
            myobj.remove();
        }
        if (document.getElementById("line")){
            var myobj = document.getElementById("line");
            myobj.remove();
        }
        $.ajax({
            url: '{% url "organization_viewnote" %}',
            type: "POST",
            data: {
                org_id: org_id,
                csrfmiddlewaretoken: "{{ csrf_token }}",
            },
            dataType: 'json',
            success: function (data) {
                if (data.id) {
                    sample = data.notes.replace(/\"/g, "")
                    $("#modal_view #notes_body").append('<div class="col" style=" padding-left: 15px; padding-right: 15px; padding-top: 10px; padding-bottom: 5px;" id="note"><label style="font-family: Roboto; font-weight: 350; font-size: 15px; color: black; letter-spacing: 1.5px; text-align: justify;">'+sample+'</label></div>')
                    console.log(sample)
                }
                if (data.error) {
                    console.log(data.error)
                }
                
            }
        });
    }    
}


function addNote(org_id){
    if (org_id) {
        tr_id = org_id;
        $('#org_id').val(org_id);
        console.log(org_id)
    }
}


$("#modal_addnote").on('click','#btn_submit',function(e){
    sample = CKEDITOR.instances.essay_text.getData();
    // sample = data.excuse_val.proof.replace(/\"/g, "")
    var org_id = $('#org_id').val();
    console.log(org_id)
    if (sample) {
        $.ajax({
            url: '{% url "organization_addnnote" %}',
            type: "POST",
            data: {
                sample: sample,
                org_id: org_id,
                csrfmiddlewaretoken: "{{ csrf_token }}",
            },
            dataType: 'json',
            success: function (data) {
                if (data.success) {
                    console.log(data.success)
                    setTimeout(function(){
                        swal("Success! User has been deactivated.", {
                        icon: "success",
                        });
                        window.location.reload()
                    }, 1000);
                    $('#modal_addnote').modal('hide');
                    
                }
                if (data.error) {
                    console.log(data.error)
                    $("#error").append('<div class="container col-lg-12" id="error_msg"><p class="alert alert-danger text-center" >Warning! invalid.' + '</p></div>')
                    setTimeout(function(){
                        if (document.getElementById("error_msg")){
                            var myobj = document.getElementById("error_msg");
                            myobj.remove();
                        }
                    }, 2000);
                }
                
            }
        });
    } 
    else{
        $("#error").append('<div class="container col-lg-12" id="error_msg"><p class="alert alert-danger text-center" >Warning! invalid input.' + '</p></div>')
        setTimeout(function(){
            if (document.getElementById("error_msg")){
                var myobj = document.getElementById("error_msg");
                myobj.remove();
            }
        }, 2000);
    }
});
</script>
{% endblock %}

